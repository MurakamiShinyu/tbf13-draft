---
title: "rem へ寄せてゆく"
author: "akabeko"
---

# rem へ寄せてゆく

CSS におけるサイズ単位のひとつである `rem`。これは主に文字を対象とするものだが、他の要素にも適用してゆくことで得られる利点について書く。

## CSS のサイズ単位

CSS のサイズ単位は絶対長と相対長へ大別される。詳細は以下の記事を参照のこと。

- CSS の値と単位 - ウェブ開発を学ぶ | MDN  
  https://developer.mozilla.org/ja/docs/Learn/CSS/Building_blocks/Values_and_units

絶対長は他の長さに影響されず、サイズは常に一定。代表的なものは `px` や `pt` など。ディスプレイ (以降、本記事ではこの語を PC 向けディスプレイとして用いる) や紙面などの出力媒体で定められた長さとなる。CSS は主に Web ブラウザーを対象とするため `px` を利用することが多い。本書のように紙面も想定しているならば `@media print` で `pt` や `cm` へ切り替えることもある。

相対長はなんらかの長さに対してサイズが変化する。この性質により出力媒体によるサイズの差へ対応しやすい。代表的なものは `em`、そして本記事の主題である `rem` など。`%` は単位ではなく割合だが、用途としては相対なので本記事ではこちらに含める。

## 絶対・相対長の課題と rem

先に絶対長と相対長それぞれの課題を挙げ、それらを解決する手段としての `rem` を考察する。

### 絶対長

絶対長はそれ自体の長さこと絶対的だが、出力媒体には依存する。媒体が紙面であれば物理サイズとしての出力は固定なのでよい。しかしディスプレイを対象とする場合、解像度とピクセル密度による可変性が課題となる。

かつてディスプレイのピクセルは固定的であった。しかし 2010 年に iPhone 4 が採用した Retina ディスプレイのあたりから、表示上の長さは変えず、ピクセル密度を高めて精細化する方式が普及し始める。そして現在 (2022 年) は様々なプラットフォームで高解像度・高精細化が一般化して、ピクセル固定を前提とする `px` への影響が目立つようになった

`px` を指定しても OS や Web ブラウザーがディスプレイ解像度とピクセル密度を加味して、よしなに長さを変更してくれる。しかしこの処理にも限界があって、例えば 4K ディスプレイ (3840 × 2160) 上で `font-size: 12px` の文字を表示する際、解像度そのままだとディスプレイの物理サイズによっては読めたものではない。物理サイズが 27 インチぐらいあればよいのだが、15 インチなどでは文字が点のように見えるだろう。そのため OS のディスプレイ設定で拡大指定する必要がある。

では `14px`、`16px` のように大きくしてゆけばよいのだろうか？そうした場合、逆に低解像度の環境としては大きすぎるかもしれない。ここに課題の本質がある。それは絶対長を想定しても実際には可変、つまり相対長のように振る舞うことである。絶対長を保証するには出力媒体を固定しなければならない。

### 相対長

相対長は基準に応じて長さを変える柔軟性があるため、出力媒体の差を緩和した表示を可能とする。ただし基準が課題となる。

`em` や `%` は親に指定された長さを基準とするため、サイズ予想が難しい。例えば以下の HTML/CSS において `<p>` の `font-size` は親の `.parent` に指定された `12px` を基準とした `0.9em` となる。そのため `10.8px` として出力されるが、これは想定どおりだろうか？

```html
<style>
  .parent {
    font-size: 12px;
  }

  p {
    font-size: 0.9em;
  }
</style>
<div class="parent">
  <p>テキスト</p>
</div>
```

親のサイズ指定が絶対長ならば、まだよい。これが相対長になるとますます予想は難しくなる。例えば以下の HTML/CSS で `<p>` のサイズを予想できるだろうか？正解は `9.72px` だが、`<p>` の位置を `.parent` 直下へ移動すると前述の `10.8px` になる。

```html
<style>
  .parent {
    font-size: 12px;
  }

  .child {
    font-size: 0.9em;
  }

  p {
    font-size: 0.9em;
  }
</style>
<div class="parent">
  <div class="child">
    <p>テキスト</p>
  </div>
</div>
```

この難しさもあってか、`em` よりも `px` を選ばれることがある。もしくは `em` を採用しつつも HTML/CSS を慎重に設計する、BEM のような CSS 命名で親子関係の明確化とある程度の一意性を担保する、などの方法により想定内へ収めたりする。

しかし親の長さを基準とする以上、本質的な課題は解決していない。

### rem

相対長のひとつに `rem` がある。

これは長さの基準を親ではなくページのルート要素に設定された文字サイズとする点が特徴。HTML のルート要素は `<html>` なので、ここが `font-size: 16px` ならば `1rem` は `16px` になる。`<html>` の既定文字サイズは Web ブラウザーの設定となるため、`rem` にも反映される。

つまり相対長でありながら基準をひとつとすることで、絶対長のように扱える。試しに相対長の課題として挙げた HTML/CSS へ `rem` を適用してみよう。これを Web ブラウザーで表示すると、`<p>` の文字は `14.4px` になった。`1rem` に変えたら `16px` となるので、このサイズに対する `0.9` ということなのだろう。

```html
<style>
  .parent {
    font-size: 12px;
  }

  .child {
    font-size: 0.9em;
  }

  p {
    /* 0.9em を 0.9rem に変更 */
    font-size: 0.9rem;
  }
</style>
<div class="parent">
  <div class="child">
    <p>テキスト</p>
  </div>
</div>
```

ここでひとつ注意が必要。ルート要素 `<html>` の文字サイズがどこのように決定されるか？である。これは Web ブラウザーによって挙動が異なるようだ。MacBook Pro 15 2019 (Monterey) 上で試したところ、以下のようになった。

- Firefox 103.0.2
  - `<html>` の既定は `16px`
  - `<html>` 要素へ明示的に `font-size: 1rem` を指定すると Firefox に設定された文字サイズが反映される
- Chrome 104.0.5112.101
  - `<html>` 要素の指定がなくとも Chrome に設定されたサイズ (この環境だと 大 = 20px) が反映される
- Safari 15.6.1
  - `<html>` の既定は `16px`
  - Safari は最小の文字サイズのみ設定可能、これを下回る `font-size` は無視されて最小サイズ設定が反映される
  - 既定値 `16px` を基準とした `rem` が最小サイズを上回れば、それが反映される
  - 最小サイズ `24px` で `1rem` だと既定の `16px` なので `24px` になるが、`2rem` なら `32px` なのでそのまま反映される

ユーザーが明示的に文字サイズを指定した場合を考慮すると、`<html>` に対して明示的に `1rem` を指定するのがよさそうだ。そうすれば `em` や `%` と異なり、親要素になにが設定されていても妥当なサイズを設定してくれるだろう。

## レイアウト基準を「rem = 文字」へ寄せてゆく
